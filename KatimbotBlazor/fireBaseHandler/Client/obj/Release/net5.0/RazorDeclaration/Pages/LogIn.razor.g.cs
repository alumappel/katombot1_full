// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace fireBaseHandler.Client.Pages
{
    #line hidden
    using System;
    using System.Collections.Generic;
    using System.Linq;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 3 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using Microsoft.AspNetCore.Components.WebAssembly.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using fireBaseHandler.Client;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using fireBaseHandler.Client.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using fireBaseHandler;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using fireBaseHandler.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using BlazorAnimate;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\Pages\LogIn.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\Pages\LogIn.razor"
using System.Net.Http.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\Pages\LogIn.razor"
using System.Threading.Tasks;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\Pages\LogIn.razor"
using fireBaseHandler.Shared.Entities;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\Pages\LogIn.razor"
using fireBaseHandler.Client.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\Pages\LogIn.razor"
using fireBaseHandler.Client.Services;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Components.RouteAttribute("/LogIn")]
    public partial class LogIn : global::Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(global::Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 82 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\Pages\LogIn.razor"
       
    bool load = false;
    string message = "";
    LogInData myUser = new LogInData();
    bool show = true;
    bool forgot = false;
    string mail = "";
    LogInData forget = new LogInData() { Password="error" };

    protected override async Task OnInitializedAsync()
    {
        var user = sessionStorage.GetItem<LogInData>("user");
        if (user != null)
        {
            navigat.NavigateTo("./MainPage");
        }
    }
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {

        try
        {
            await JSRuntime.InvokeVoidAsync("stopS");
        }
        catch { }

    }
    private protected async Task FormSubmit()
    {
        string res;

        load = true;
        var getResponse = await Http.PostAsJsonAsync("api/FireBase/logIn", myUser);
        Http.DefaultRequestHeaders.ConnectionClose = true;


        try
        {
            LogInData myuser = new LogInData();
            myuser = getResponse.Content.ReadFromJsonAsync<LogInData>().Result;
            await JSRuntime.InvokeVoidAsync("login");
            sessionStorage.SetItem("user", myuser);
            sessionStorage.SetItem("isnew", false);
            logged.isLog = true;
            navigat.NavigateTo("./MainPage");

        }
        catch
        {
            res = await getResponse.Content.ReadAsStringAsync();
            message = res;
            switch (res)
            {
                case "wrong password":
                    message = "סיסמא שגויה";
                    break;
                case "problem":
                    message = "קרתה תקלה";
                    break;
                case "no mail":
                    message = "לא קיים מייל כזה במערכת";
                    break;
                default:
                    message = message;
                    break;

            }

            load = false;


        }

    }

    private void Invalid()
    {

    }
    private void closeF()
    {
        forgot = false;
        message = "";

    }
    private void forgetP()
    {
        forgot = true;
        forget.Mail = myUser.Mail;
        message = "";
    }
    private protected async Task send()
    {

        load = true;
        forget.Password = "error";
        var postResponse = await Http.PostAsJsonAsync("api/FireBase/Mail", forget);
        LogInData myuser = new LogInData();

        try
        {
            myuser = postResponse.Content.ReadFromJsonAsync<LogInData>().Result;
            load = false;
            if (postResponse.IsSuccessStatusCode)
                message = myuser.FirstName + " הסיסמא נשלחה למייל שלך";
            else
            {
                string res = postResponse.Content.ReadAsStringAsync().Result;
                if (res == "no mail")
                {
                    message = "לא הצלחנו למצוא אותך, ";

                }
                else
                {
                    message =  "קרתה תקלה";
                }

            }
        }
        catch
        {
            load = false;
            string res = postResponse.Content.ReadAsStringAsync().Result;
            if (res == "no mail")
            {
                message = "לא הצלחנו למצוא אותך, ";

            }
            else
            {
                message = "קרתה תקלה";
            }

        }


    }
    private void signUp()
    {
        navigat.NavigateTo("./SignUp");

    }



#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private Services.IsLog logged { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private Blazored.SessionStorage.ISyncSessionStorageService sessionStorage { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private HttpClient Http { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager navigat { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IJSRuntime JSRuntime { get; set; }
    }
}
#pragma warning restore 1591
