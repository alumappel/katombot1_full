// <auto-generated/>
#pragma warning disable 1591
#pragma warning disable 0414
#pragma warning disable 0649
#pragma warning disable 0169

namespace fireBaseHandler.Client.Pages
{
    #line hidden
    using System.Collections.Generic;
    using System.Linq;
    using Microsoft.AspNetCore.Components;
#nullable restore
#line 2 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using System.Net.Http.Json;

#line default
#line hidden
#nullable disable
#nullable restore
#line 3 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using Microsoft.AspNetCore.Components.Forms;

#line default
#line hidden
#nullable disable
#nullable restore
#line 4 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using Microsoft.AspNetCore.Components.Routing;

#line default
#line hidden
#nullable disable
#nullable restore
#line 5 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using Microsoft.AspNetCore.Components.Web;

#line default
#line hidden
#nullable disable
#nullable restore
#line 6 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using Microsoft.AspNetCore.Components.Web.Virtualization;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using Microsoft.AspNetCore.Components.WebAssembly.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using Microsoft.JSInterop;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using fireBaseHandler.Client;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using fireBaseHandler.Client.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using fireBaseHandler.Client.Components;

#line default
#line hidden
#nullable disable
#nullable restore
#line 12 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using fireBaseHandler;

#line default
#line hidden
#nullable disable
#nullable restore
#line 13 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using fireBaseHandler.Shared;

#line default
#line hidden
#nullable disable
#nullable restore
#line 14 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using BlazorAnimate;

#line default
#line hidden
#nullable disable
#nullable restore
#line 15 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\_Imports.razor"
using fireBaseHandler.Client.Services;

#line default
#line hidden
#nullable disable
#nullable restore
#line 7 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\Pages\MyPresentation.razor"
using System.IO;

#line default
#line hidden
#nullable disable
#nullable restore
#line 8 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\Pages\MyPresentation.razor"
using System;

#line default
#line hidden
#nullable disable
#nullable restore
#line 9 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\Pages\MyPresentation.razor"
using System.Net.Http;

#line default
#line hidden
#nullable disable
#nullable restore
#line 10 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\Pages\MyPresentation.razor"
using System.Threading.Tasks;

#line default
#line hidden
#nullable disable
#nullable restore
#line 11 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\Pages\MyPresentation.razor"
using fireBaseHandler.Shared.Entities;

#line default
#line hidden
#nullable disable
    [global::Microsoft.AspNetCore.Components.RouteAttribute("/Presentation")]
    public partial class MyPresentation : global::Microsoft.AspNetCore.Components.ComponentBase
    {
        #pragma warning disable 1998
        protected override void BuildRenderTree(global::Microsoft.AspNetCore.Components.Rendering.RenderTreeBuilder __builder)
        {
        }
        #pragma warning restore 1998
#nullable restore
#line 194 "C:\Users\Aluma\Documents\katombot1_full\KatimbotBlazor\fireBaseHandler\Client\Pages\MyPresentation.razor"
       
    int score = 0;
    //איפוס משתנים
    string subject = "";
    private string frameUri;
    bool save = false;
    bool vidOn = false;
    string message = "";
    bool finish = false;
    bool loadFeedback = false;
    int Width = 0;
    int Height = 0;
    string pnum;
    string newName = "";
    bool rando = false;
    bool ardu = true;
    LogInData user = new LogInData();
    PresentationInfo newP = new PresentationInfo();
    bool ins = false;
    int pcount;
    string canID = "canvas";
    string vidID = "video";
    string arduclass = "thereArd";
    List<string> ideas = new List<string>() {
        "משבר האקלים",
        "ההיסטוריה של ישראל",
        "צמחונות",
        "רעיון לסטארטאפ",
        "מיחזור בקבוקים",
        "חיסונים",
        "משמעות החיים",
        "סדר היום שלי",
        "למה לקבל אותי לעבודה",
        "הכירו אותי",
        "טכנולוגיות למידה",
        "מיומנויות למידה",
        "האירוויזיון",
        "מנהיגות",
        "תרבות ישראלית",
        "מדינות בעולם",
        "מצב החסה בשטחים",
        "ניסויים על בעלי חיים",
        "בחירות",
        "תחבורה ציבורית",
        "זכויות עובדים",
        "פוליטיקה",
        "תוכניות ריאליטי"

    };
    protected void noArd()
    {
        ardu = false;
            arduclass = "noArd";
     
    }    
    protected void thereArd()
    {
        ardu = true;

            arduclass = "thereArd";
      

    }


    void closeins()
    {
        ins = false;
    }
    protected void closeROK()
    {
        newP.Name = newName;
        rando = false;

    }
    protected void closeR()
    {
        newName = "";
        rando = false;

    }
    protected void openR()
    {
        Random rnd = new Random();
        int size = ideas.Count;
        newName = ideas[rnd.Next(size)];
        rando = true;
    }
    //גודל וידאו
    protected override async Task OnInitializedAsync()
    {
        user = sessionStorage.GetItem<LogInData>("user");
        sessionStorage.SetItem("show", 0);

        if (user == null)
            navigat.NavigateTo("./LogIn");
        else
        {
            var width = await JSRuntime.InvokeAsync<int>("getwidth");
            var height = await JSRuntime.InvokeAsync<int>("getheight");
            Height = height;
            Width = width;
            newP.Type = "front";
            pcount = sessionStorage.GetItem<int>("pcount");

            //canID += DateTime.Now.ToShortTimeString().Replace(".", "").Replace(":","");
            //vidID += DateTime.Now.ToShortTimeString().Replace(".", "").Replace(":", "");
            if (pcount > 0)
                ins = false;
            else
                ins = true;


        }

    }
    protected override async Task OnAfterRenderAsync(bool firstRender)
    {
        try
        {
            await JSRuntime.InvokeVoidAsync("stopS");
        }
        catch { }
    }
    //הפעלה של המצלמה דרך JS

    protected async Task start()
    {

        //הוספת זמן
        string date = DateTime.Today.ToShortDateString();
        //יצירת מופע של מידע לפרזנטציה
        newP.Date = date;
        //ניסיון קריאה לשרת
        try
        {
            save = true;
            //פרזנטציה חדשה
            var getResponse = await Http.PostAsJsonAsync("api/FireBase/NewPresUser/u" + user.ID.ToString() + "/" + ardu.ToString(), newP);
            Http.DefaultRequestHeaders.ConnectionClose = true;
            pnum = await getResponse.Content.ReadAsStringAsync();
            await Task.Delay(500);
            if (ardu)
                await JSRuntime.InvokeVoidAsync("playTurnOn");
            if (!ardu)
                await startVid();
        }
        catch
        {
            //הודעת שגיאה
            message = "קרתה תקלה, אי אפשר כרגע להתחיל את הפרזנטציה";
        }


    }

    protected async Task startVid()
    {
        //user, presentation, ardu, type,canID, vidID
        await JSRuntime.InvokeVoidAsync("startVideo", user.ID.ToString(), pnum, ardu, newP.Type);
        vidOn = true;

    }
    protected async Task startNoArd()
    {
        ardu = false;
        await JSRuntime.InvokeVoidAsync("startVideo", user.ID.ToString(), pnum, false, newP.Type);
        vidOn = true;
    }

    protected async Task notsave()
    {
        var getResponse = await Http.GetAsync("api/FireBase/DelEmpty/u" + user.ID.ToString() + "/" + pnum.ToString());
        vidOn = false;
        save = false;

    }

    protected void ardOff()
    {
        ardu = false;
    }
    //לחיצה על כפתור סיום
    protected async Task endVid()
    {
        await JSRuntime.InvokeVoidAsync("stopVid");
        finish = true;
        Presentation mypres = new Presentation();
        var getPresentation = await Http.GetAsync("api/FireBase/Presentation/u" + user.ID.ToString() + "/" + pnum);
        try
        {
            mypres = await getPresentation.Content.ReadFromJsonAsync<Presentation>();
            sessionStorage.SetItem("myP", pnum);
            sessionStorage.SetItem("isnew", false);
            sessionStorage.SetItem("newPre", true);

            loadFeedback = true;
            pcount++;
            sessionStorage.SetItem("pcount", pcount);

        }
        catch
        {
            message = "בעיה";
        }

        //navigat.NavigateTo("./MainPage");

    }


#line default
#line hidden
#nullable disable
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private Blazored.SessionStorage.ISyncSessionStorageService sessionStorage { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private NavigationManager navigat { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private HttpClient Http { get; set; }
        [global::Microsoft.AspNetCore.Components.InjectAttribute] private IJSRuntime JSRuntime { get; set; }
    }
}
#pragma warning restore 1591
